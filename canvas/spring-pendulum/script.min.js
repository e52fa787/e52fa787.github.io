'use strict';(h=>{h.addEventListener("load",()=>{const w=h.document,B=w.body;var q=a=>{const b=w.getElementById(a);if(b)return b;throw Error("Element #"+a+" not found");};const k=(a,b,c,d)=>{for(const e of b.split(" "))d?a.removeEventListener(e,c):a.addEventListener(e,c)},I=()=>{const a=w.timeline.currentTime;if("number"===typeof a)return a;throw Error("document.timeline.currentTime is not a number");},l=q("controls"),X=q("css-output"),Y=l.getElementsByTagName("header")[0],Z=l.getElementsByTagName("ul")[0],
aa=l.getElementsByClassName("toggle-dropdown")[0],J=q("toggle-animation"),ba=q("reset-canvas"),C=q("output-coords");let ca=C.innerHTML;k(h,"blur",()=>{});k(h,"focus",()=>{});const D=[0,0],v=(a=>[a.left,a.top])(l.getBoundingClientRect()),E=(a,b=2)=>Math.round(a*10**b)/10**b,n=(a,b)=>{a.splice(0,a.length,...b)},N=a=>{if("touches"in a){const b=a.changedTouches;a=a.touches[0]??b[0];return[a.clientX,a.clientY]}return[a.clientX,a.clientY]},O=(a,b,c)=>{let [d,e]=a;0>d?d=0:d>b&&(d=b);0>e?e=0:e>c&&(e=c);return[d,
e]},P=(a,b,c,d)=>{const e=m=>{m.preventDefault();c.call(this,N(m),m)},g=()=>{d&&d.call(this);k(w,"touchmove mousemove touchend mouseup",e,!0);k(h,"blur",g,!0)};k(a,"touchstart mousedown",m=>{m.preventDefault();b.call(this,N(m),m);k(w,"touchmove mousemove",e);k(w,"touchend mouseup",g);k(h,"blur",g)})};P(Y,a=>{n(D,a);l.classList.add("currentlyDragging")},a=>{v[0]+=a[0]-D[0];v[1]+=a[1]-D[1];n(D,a);const [b,c]=O(v,B.clientWidth-l.clientWidth,B.clientHeight-l.clientHeight);l.style.transform="translate("+
b+"px,"+c+"px)"},()=>{l.classList.remove("currentlyDragging");n(v,O(v,B.clientWidth-l.clientWidth,B.clientHeight-l.clientHeight))});k(aa,"click",()=>{l.classList.toggle("closed")});X.innerHTML="#controls>ul{max-height:"+2*Z.childElementCount+"em;}";k(J,"change",()=>{J.checked?h.requestAnimationFrame(Q):h.cancelAnimationFrame(R)});k(ba,"click",()=>{S=0;r=[3.27,0,0,0];f.clearRect(0,0,x,y)});const F=q("canvas"),f=F.getContext("2d"),p=[0,0],K=[0,0];let L,T=0,R,x=0,y=0,S=0,U=0,V=0;q=()=>{x=h.innerWidth;
y=h.innerHeight;F.width=x;F.height=y};q();k(h,"resize",q);const t=(a,b)=>a.map((c,d)=>c+b[d]),M=(a,b)=>a.map((c,d)=>c-b[d]),u=(a,b)=>b.map(c=>a*c),W=a=>a.reduce((b,c)=>b+c*c,0),z=[x/200,y/600],A=t(z,[0,1]);let G=!1,r=[3.27,.1,0,0];const da=(a,b,c=0,d=0)=>{a=M([a,b],z);b=Math.sqrt(W(a));const e=Math.atan2(a[0],a[1]);var g=0;let m=0;(c||d)&&0<b&&(g=c*c+d*d,16<g&&(g=4*g**-.5,c*=g,d*=g),m=(c*a[1]-d*a[0])/b,g=(a[0]*c+a[1]*d)/b);return[b-1,e,g,m]},ea=(a,b)=>t(z,u(1+a,[Math.sin(b),Math.cos(b)])),H=(a,b,
c,d)=>{const e=1+a;return[c,d,e*d*d-3*a+9.81*Math.cos(b)-.1*c,-(9.81*Math.sin(b)+2*c*d)/e-.1*d]},Q=(a=I())=>{f.clearRect(0,0,x,y);S++;V=Math.min(a-U,30);U=a;if(G)n(A,p);else{a=r;var b=r;var c=.001*V;const d=H(...b),e=H(...t(b,u(c/2,d))),g=H(...t(b,u(c/2,e))),m=H(...t(b,u(c,g)));b=t(b,t(u(c/6,t(d,m)),u(c/3,t(e,g))));n(a,b);.3>r[0]+1&&(r[0]=-.7,r[2]=-r[2]);n(A,ea(...r))}f.beginPath();f.scale(100,100);f.arc(...z,.15,0,2*Math.PI);f.fillStyle="#333";f.fill();f.moveTo(...z);f.lineWidth=.03;f.lineTo(...A);
f.strokeStyle="#333";f.stroke();f.beginPath();f.arc(...A,.15,0,2*Math.PI);f.fillStyle="#ccc";f.fill();f.setTransform(1,0,0,1,0,0);R=h.requestAnimationFrame(Q)};P(F,a=>{n(p,u(.01,a));L=I();J.checked&&.09>=W(M(p,A))&&(G=!0);C.innerHTML=E(p[0])+", "+E(p[1])},a=>{a=u(.01,a);const b=I()-L;L+=b;0<b&&n(K,u(1E3/b,M(a,p)));n(p,a);clearTimeout(T);T=setTimeout(()=>{n(K,[0,0])},50);C.innerHTML=E(p[0])+", "+E(p[1])},()=>{G&&(n(r,da(...p,...K)),G=!1);C.innerHTML=ca})})})(window);