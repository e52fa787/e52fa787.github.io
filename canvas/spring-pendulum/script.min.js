(e=>{"use strict";e.addEventListener("load",()=>{var t;let n=e.document,l=n.body,r="touchmove mousemove",i="touchend mouseup",$=e=>{let t=n.getElementById(e);if(t)return t;throw Error("Element #"+e+" not found")},o=(e,t,n,l)=>{for(let r of t.split(" "))l?e.removeEventListener(r,n):e.addEventListener(r,n)},c=()=>{let e=n.timeline.currentTime;if("number"==typeof e)return e;throw Error("document.timeline.currentTime is not a number")},a=$("controls"),s=$("css-output"),u=$("output-coords"),m=u.innerHTML,g=!0,d=()=>{g=!1};o(e,"blur",d);let h=()=>{g=!0};o(e,"focus",h);let _=[0,0],p=[(t=a.getBoundingClientRect()).left,t.top],f=(e,t=2)=>Math.round(e*10**t)/10**t,v=(e,t)=>{e.splice(0,e.length,...t)},L=e=>{if(!("touches"in e))return[e.clientX,e.clientY];{let{touches:t,changedTouches:n}=e,l=t[0]??n[0];return[l.clientX,l.clientY]}},P=(e,t,n)=>{let[l,r]=e;return l<0?l=0:l>t&&(l=t),r<0?r=0:r>n&&(r=n),[l,r]},b=(t,l,$,c)=>{let a=t=>{t.preventDefault(),l.call(this,L(t),t),o(n,r,s),o(n,i,u),o(e,"blur",u)},s=e=>{e.preventDefault(),$.call(this,L(e),e)},u=()=>{c&&c.call(this),o(n,r+" "+i,s,!0),o(e,"blur",u,!0)};o(t,"touchstart mousedown",a)},x=a.getElementsByTagName("header")[0];b(x,e=>{v(_,e),a.classList.add("currentlyDragging")},e=>{p[0]+=e[0]-_[0],p[1]+=e[1]-_[1],v(_,e);let[t,n]=P(p,l.clientWidth-a.clientWidth,l.clientHeight-a.clientHeight);a.style.transform="translate("+t+"px,"+n+"px)"},()=>{a.classList.remove("currentlyDragging"),v(p,P(p,l.clientWidth-a.clientWidth,l.clientHeight-a.clientHeight))});let M=a.getElementsByClassName("toggle-dropdown")[0],y=()=>{a.classList.toggle("closed")};o(M,"click",y);let T=a.getElementsByTagName("ul")[0],k=()=>{s.innerHTML="#controls>ul{max-height:"+2*T.childElementCount+"em;}"};k();let B=$("toggle-animation"),E=()=>{B.checked?e.requestAnimationFrame(eo):e.cancelAnimationFrame(I)};o(B,"change",E);let H=()=>{q.clearRect(0,0,N,R)},W=$("reset-canvas"),w=()=>{X=0,Object.assign(U,Q),en=[U.g/U.k,0,0,0],V(null),H()};o(W,"click",w);let S=$("canvas"),q=S.getContext("2d"),C=[0,0],D=[0,0],A,F=0,I,N=0,R=0,X=0,Y=0,z=0,j=()=>{N=e.innerWidth,R=e.innerHeight,S.width=N,S.height=R};j(),o(e,"resize",j);let G=(e,t)=>e.map((e,n)=>e+t[n]),J=(e,t)=>e.map((e,n)=>e-t[n]),K=(e,t)=>t.map(t=>e*t),O=e=>e.reduce((e,t)=>e+t*t,0),Q={L0:1,g:9.8,k:3,pxPerM:100,ldc:.1,rBob:.15,rPivot:.15},U=Object.assign({},Q),V=e=>{for(let t in U)if(t){let n=a.querySelector('[data-param="'+t+'"]'),l=n?.nextSibling;if(n&&l&&n instanceof HTMLInputElement&&l instanceof HTMLInputElement){let r=[n,l];r.forEach((n,l)=>{n.value=U[t],e&&e(t,n,r[1-l])})}}};V((e,t,n)=>{o(t,"input",()=>{let l=t.value;U[e]=l,n.value=l})});let Z=[N/(2*U.pxPerM),R/(6*U.pxPerM)],ee=G(Z,[0,100/U.pxPerM]),et=!1,en=[U.g/U.k,.1,0,0],el=(e,t,n=0,l=0)=>{let r=J([e,t],Z),i=Math.sqrt(O(r)),$=i-U.L0,o=Math.atan2(r[0],r[1]),c=0,a=0;if((n||l)&&i>0){let s=n*n+l*l;if(s>16){let u=4*s**-.5;n*=u,l*=u}a=(n*r[1]-l*r[0])/i,c=(r[0]*n+r[1]*l)/i}return[$,o,c,a]},er=(e,t,n,l)=>{let r=U.L0+e;return G(Z,K(r,[Math.sin(t),Math.cos(t)]))},ei=(e,t,n,l)=>{let r=U.L0+e;return[n,l,r*l*l-U.k*e+U.g*Math.cos(t)-U.ldc*n,-(U.g*Math.sin(t)+2*n*l)/r-U.ldc*l]},e$=(e,t)=>{let n=ei(...e),l=ei(...G(e,K(t/2,n))),r=ei(...G(e,K(t/2,l))),i=ei(...G(e,K(t,r)));return G(e,G(K(t/6,G(n,i)),K(t/3,G(l,r))))},eo=(t=c())=>{H(),X++,z=Math.min(t-Y,30),Y=t,et?v(ee,C):(v(en,e$(en,.001*z)),en[0]+U.L0<U.rBob+U.rPivot&&(en[0]=U.rPivot+U.rBob-U.L0,en[2]=-en[2]),v(ee,er(...en))),q.beginPath(),q.scale(U.pxPerM,U.pxPerM),q.arc(...Z,U.rPivot,0,2*Math.PI),q.fillStyle="#333",q.fill(),q.moveTo(...Z),q.lineWidth=3/U.pxPerM,q.lineTo(...ee),q.strokeStyle="#333",q.stroke(),q.beginPath(),q.arc(...ee,U.rBob,0,2*Math.PI),q.fillStyle="#ccc",q.fill(),q.setTransform(1,0,0,1,0,0),I=e.requestAnimationFrame(eo)};b(S,e=>{v(C,K(1/U.pxPerM,e)),A=c(),B.checked&&O(J(C,ee))<=8*U.rBob**2&&(et=!0),u.innerHTML=f(C[0])+", "+f(C[1])},e=>{let t=K(1/U.pxPerM,e),n=c()-A;A+=n,n>0&&v(D,K(1e3/n,J(t,C))),v(C,t),clearTimeout(F),F=setTimeout(()=>{v(D,[0,0])},50),u.innerHTML=f(C[0])+", "+f(C[1])},()=>{et&&(v(en,el(...C,...D)),et=!1),u.innerHTML=m})})})(window);